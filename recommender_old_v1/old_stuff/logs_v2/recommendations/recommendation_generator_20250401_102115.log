2025-04-01 10:21:15,416 - recommendation_generator - INFO - Logging to logs/recommendations\recommendation_generator_20250401_102115.log
2025-04-01 10:21:15,416 - recommendation_generator - INFO - 
####################################################################################################
2025-04-01 10:21:15,416 - recommendation_generator - INFO - RECOMMENDATION GENERATOR STARTED
2025-04-01 10:21:15,416 - recommendation_generator - INFO - ####################################################################################################
2025-04-01 10:21:15,416 - recommendation_generator - INFO - Command arguments:
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   model: models/checkpoints/best_model.pt
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   users: notebooks/shipping_10k_data/features/user_features.csv
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   items: notebooks/shipping_10k_data/features/item_features.csv
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   manifest: notebooks/shipping_10k_data/feature_manifest.yaml
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   user: 290
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   users_file: None
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   all_users: False
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   item: None
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   output: recommendations/user290_recommendations.csv
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   top_k: 10
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   exclude_history: None
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   cuda: False
2025-04-01 10:21:15,416 - recommendation_generator - INFO -   debug: True
2025-04-01 10:21:15,416 - recommendation_generator - INFO - ####################################################################################################

2025-04-01 10:21:15,416 - recommendation_generator - INFO - Using device: cpu
2025-04-01 10:21:15,416 - recommendation_generator - INFO - 
****************************************************************************************************
2025-04-01 10:21:15,416 - recommendation_generator - INFO - RECOMMENDATION ENGINE INITIALIZATION FROM CHECKPOINT
2025-04-01 10:21:15,432 - recommendation_generator - INFO - ****************************************************************************************************
2025-04-01 10:21:15,432 - recommendation_generator - INFO - Model path: models/checkpoints/best_model.pt
2025-04-01 10:21:15,432 - recommendation_generator - INFO - User features path: notebooks/shipping_10k_data/features/user_features.csv
2025-04-01 10:21:15,432 - recommendation_generator - INFO - Item features path: notebooks/shipping_10k_data/features/item_features.csv
2025-04-01 10:21:15,432 - recommendation_generator - INFO - Feature manifest path: notebooks/shipping_10k_data/feature_manifest.yaml
2025-04-01 10:21:15,432 - recommendation_generator - INFO - Device: cpu
2025-04-01 10:21:15,432 - recommendation_generator - INFO - Loading model from checkpoint...
2025-04-01 10:21:15,463 - recommendation_generator - INFO - Model loaded successfully with manifest
2025-04-01 10:21:15,463 - recommendation_generator - INFO - Model dimensions: user_input_dim=81, item_input_dim=25
2025-04-01 10:21:15,463 - recommendation_generator - INFO - Model has feature manifest information
2025-04-01 10:21:15,463 - recommendation_generator - INFO - Model dimensions from manifest: {'item_input_dim': 65, 'user_input_dim': 115}
2025-04-01 10:21:15,463 - recommendation_generator - INFO - Loading user features from notebooks/shipping_10k_data/features/user_features.csv...
2025-04-01 10:21:15,510 - recommendation_generator - INFO - Loaded user features, shape: (4818, 82)
2025-04-01 10:21:15,510 - recommendation_generator - INFO - User features columns: ['age', 'monthly_hours', 'genre_diversity', 'avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature', 'listening_depth', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'user_id']
2025-04-01 10:21:15,510 - recommendation_generator - INFO - User features types: age                                    float64
monthly_hours                          float64
genre_diversity                        float64
avg_danceability                       float64
avg_energy                             float64
                                        ...   
age_group_genre_young_adult_pop        float64
age_group_genre_young_adult_rb_soul    float64
age_group_genre_young_adult_rock       float64
age_group_genre_young_adult_unknown    float64
user_id                                  int64
Length: 82, dtype: object
2025-04-01 10:21:15,510 - recommendation_generator - INFO - Loading item features from notebooks/shipping_10k_data/features/item_features.csv...
2025-04-01 10:21:15,527 - recommendation_generator - INFO - Loaded item features, shape: (1415, 26)
2025-04-01 10:21:15,527 - recommendation_generator - INFO - Item features columns: ['year', 'duration_ms', 'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature', 'duration_ms.1', 'song_age', 'duration_min', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad', 'track_id']
2025-04-01 10:21:15,527 - recommendation_generator - INFO - Item features types: year                           float64
duration_ms                    float64
danceability                   float64
energy                         float64
key                            float64
loudness                       float64
mode                           float64
speechiness                    float64
acousticness                   float64
instrumentalness               float64
liveness                       float64
valence                        float64
tempo                          float64
time_signature                 float64
duration_ms.1                  float64
song_age                       float64
duration_min                   float64
duration_category_long         float64
duration_category_medium       float64
duration_category_short        float64
duration_category_very_long    float64
mood_category_angry            float64
mood_category_happy            float64
mood_category_peaceful         float64
mood_category_sad              float64
track_id                         int64
dtype: object
2025-04-01 10:21:15,527 - recommendation_generator - INFO - Creating recommendation engine...
2025-04-01 10:21:15,527 - recommendation_generator - INFO - 
================================================================================
2025-04-01 10:21:15,527 - recommendation_generator - INFO - RECOMMENDATION ENGINE INITIALIZATION - DATA INSPECTION
2025-04-01 10:21:15,527 - recommendation_generator - INFO - ================================================================================
2025-04-01 10:21:15,527 - recommendation_generator - INFO - User features shape: (4818, 82)
2025-04-01 10:21:15,527 - recommendation_generator - INFO - User features columns: ['age', 'monthly_hours', 'genre_diversity', 'avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature', 'listening_depth', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'user_id']
2025-04-01 10:21:15,527 - recommendation_generator - INFO - User features dtypes:
age                                    float64
monthly_hours                          float64
genre_diversity                        float64
avg_danceability                       float64
avg_energy                             float64
                                        ...   
age_group_genre_young_adult_pop        float64
age_group_genre_young_adult_rb_soul    float64
age_group_genre_young_adult_rock       float64
age_group_genre_young_adult_unknown    float64
user_id                                  int64
Length: 82, dtype: object
2025-04-01 10:21:15,543 - recommendation_generator - INFO - User features sample (first 3 rows):
        age  monthly_hours  genre_diversity  avg_danceability  avg_energy   avg_key  avg_loudness  avg_mode  avg_speechiness  avg_acousticness  avg_instrumentalness  avg_liveness  avg_valence  avg_tempo  avg_time_signature  listening_depth  age_group_adult  age_group_middle_aged  age_group_senior  age_group_teen  age_group_young_adult  age_group_genre_adult_classical  age_group_genre_adult_country  age_group_genre_adult_electronic  age_group_genre_adult_folk  age_group_genre_adult_hip_hop  age_group_genre_adult_jazz  age_group_genre_adult_latin  age_group_genre_adult_other  age_group_genre_adult_pop  age_group_genre_adult_rb_soul  age_group_genre_adult_rock  age_group_genre_adult_unknown  age_group_genre_middle_aged_classical  age_group_genre_middle_aged_country  age_group_genre_middle_aged_electronic  age_group_genre_middle_aged_folk  age_group_genre_middle_aged_hip_hop  age_group_genre_middle_aged_jazz  age_group_genre_middle_aged_latin  age_group_genre_middle_aged_other  age_group_genre_middle_aged_pop  age_group_genre_middle_aged_rb_soul  age_group_genre_middle_aged_rock  age_group_genre_middle_aged_unknown  age_group_genre_senior_classical  age_group_genre_senior_country  age_group_genre_senior_electronic  age_group_genre_senior_folk  age_group_genre_senior_hip_hop  age_group_genre_senior_jazz  age_group_genre_senior_latin  age_group_genre_senior_other  age_group_genre_senior_pop  age_group_genre_senior_rb_soul  age_group_genre_senior_rock  age_group_genre_senior_unknown  age_group_genre_teen_classical  age_group_genre_teen_country  age_group_genre_teen_electronic  age_group_genre_teen_folk  age_group_genre_teen_hip_hop  age_group_genre_teen_jazz  age_group_genre_teen_latin  age_group_genre_teen_other  age_group_genre_teen_pop  age_group_genre_teen_rb_soul  age_group_genre_teen_rock  age_group_genre_teen_unknown  age_group_genre_young_adult_classical  age_group_genre_young_adult_country  age_group_genre_young_adult_electronic  age_group_genre_young_adult_folk  age_group_genre_young_adult_hip_hop  age_group_genre_young_adult_jazz  age_group_genre_young_adult_latin  age_group_genre_young_adult_other  age_group_genre_young_adult_pop  age_group_genre_young_adult_rb_soul  age_group_genre_young_adult_rock  age_group_genre_young_adult_unknown  user_id
0 -1.245471       0.462032         0.820488          0.254657    0.516811 -0.638312      1.469966  1.207056         1.232577         -0.205346             -1.064706      0.718250    -0.531829   0.860737           -0.078877        -0.407109              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     3954
1 -0.979005       1.168996         0.820488         -1.021574   -0.766459 -1.452319      0.691628  0.833718        -0.814644          0.439290             -0.561167      1.136262    -0.068724  -2.514090           -3.640159        -0.082599              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     4084
2 -0.512688       0.148121         0.820488          2.121240    1.420093 -1.099048      0.461868 -0.148323         2.601773         -1.286526             -0.877375      1.080125     0.661002  -0.978833            0.751359        -0.551200              1.0                    0.0               0.0             0.0                    0.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        1.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0     3280
2025-04-01 10:21:15,543 - recommendation_generator - INFO - Item features shape: (1415, 26)
2025-04-01 10:21:15,543 - recommendation_generator - INFO - Item features columns: ['year', 'duration_ms', 'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature', 'duration_ms.1', 'song_age', 'duration_min', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad', 'track_id']
2025-04-01 10:21:15,543 - recommendation_generator - INFO - Item features dtypes:
year                           float64
duration_ms                    float64
danceability                   float64
energy                         float64
key                            float64
loudness                       float64
mode                           float64
speechiness                    float64
acousticness                   float64
instrumentalness               float64
liveness                       float64
valence                        float64
tempo                          float64
time_signature                 float64
duration_ms.1                  float64
song_age                       float64
duration_min                   float64
duration_category_long         float64
duration_category_medium       float64
duration_category_short        float64
duration_category_very_long    float64
mood_category_angry            float64
mood_category_happy            float64
mood_category_peaceful         float64
mood_category_sad              float64
track_id                         int64
dtype: object
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Item features sample (first 3 rows):
       year  duration_ms  danceability    energy       key  loudness      mode  speechiness  acousticness  instrumentalness  liveness   valence     tempo  time_signature  duration_ms.1  song_age  duration_min  duration_category_long  duration_category_medium  duration_category_short  duration_category_very_long  mood_category_angry  mood_category_happy  mood_category_peaceful  mood_category_sad  track_id
0 -0.924737     1.354142     -0.791459  0.992329  1.084206  0.687860  0.731060    -0.472487     -0.668154         -0.539603  0.673052  0.181515  1.647526        0.289441       1.354142  0.924737      1.354142                     1.0                       0.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0        20
1  0.654984     0.446307      0.174468  0.893462 -0.669889  1.279397  0.731060    -0.509508     -0.765071         -0.493547 -0.686074 -0.802973 -0.393427        0.289441       0.446307 -0.654984      0.446307                     1.0                       0.0                      0.0                          0.0                  1.0                  0.0                     0.0                0.0      1109
2  0.497012    -0.572205      2.411351 -0.420650 -0.669889  0.391958 -1.367877    -0.013428     -0.749149         -0.521315  0.471700  0.745795 -0.670723        0.289441      -0.572205 -0.497012     -0.572205                     0.0                       1.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0       788
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Model type: TwoTowerHybridModel
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Model expected dimensions: user_input_dim=81, item_input_dim=25
2025-04-01 10:21:15,558 - recommendation_generator - INFO - ================================================================================

2025-04-01 10:21:15,558 - recommendation_generator - INFO - Model has feature manifest. Feature alignment will be used.
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Feature dimensions from manifest: user=115, item=65
2025-04-01 10:21:15,558 - recommendation_generator - INFO - 
================================================================================
2025-04-01 10:21:15,558 - recommendation_generator - INFO - FEATURE MANIFEST DETAILS
2025-04-01 10:21:15,558 - recommendation_generator - INFO - ================================================================================
2025-04-01 10:21:15,558 - recommendation_generator - INFO - User features in manifest: {'columns': ['country_Argentina', 'country_Australia', 'country_Brazil', 'country_Canada', 'country_Chile', 'country_Colombia', 'country_France', 'country_Germany', 'country_India', 'country_Italy', 'country_Japan', 'country_Mexico', 'country_Netherlands', 'country_Poland', 'country_South Africa', 'country_South Korea', 'country_Spain', 'country_Sweden', 'country_UAE', 'country_UK', 'country_USA', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'gender_Female', 'gender_Male', 'genre_diversity', 'monthly_hours', 'top_genre_classical', 'top_genre_country', 'top_genre_electronic', 'top_genre_folk', 'top_genre_hip_hop', 'top_genre_jazz', 'top_genre_latin', 'top_genre_other', 'top_genre_pop', 'top_genre_rb_soul', 'top_genre_rock', 'top_genre_unknown', 'avg_tempo', 'avg_energy', 'avg_mode', 'avg_time_signature', 'avg_liveness', 'avg_instrumentalness', 'avg_key', 'avg_speechiness', 'avg_danceability', 'avg_acousticness', 'avg_loudness', 'avg_valence', 'listening_depth'], 'dimension': 115, 'types': {'age_group_adult': 'float64', 'age_group_genre_adult_classical': 'float64', 'age_group_genre_adult_country': 'float64', 'age_group_genre_adult_electronic': 'float64', 'age_group_genre_adult_folk': 'float64', 'age_group_genre_adult_hip_hop': 'float64', 'age_group_genre_adult_jazz': 'float64', 'age_group_genre_adult_latin': 'float64', 'age_group_genre_adult_other': 'float64', 'age_group_genre_adult_pop': 'float64', 'age_group_genre_adult_rb_soul': 'float64', 'age_group_genre_adult_rock': 'float64', 'age_group_genre_adult_unknown': 'float64', 'age_group_genre_middle_aged_classical': 'float64', 'age_group_genre_middle_aged_country': 'float64', 'age_group_genre_middle_aged_electronic': 'float64', 'age_group_genre_middle_aged_folk': 'float64', 'age_group_genre_middle_aged_hip_hop': 'float64', 'age_group_genre_middle_aged_jazz': 'float64', 'age_group_genre_middle_aged_latin': 'float64', 'age_group_genre_middle_aged_other': 'float64', 'age_group_genre_middle_aged_pop': 'float64', 'age_group_genre_middle_aged_rb_soul': 'float64', 'age_group_genre_middle_aged_rock': 'float64', 'age_group_genre_middle_aged_unknown': 'float64', 'age_group_genre_senior_classical': 'float64', 'age_group_genre_senior_country': 'float64', 'age_group_genre_senior_electronic': 'float64', 'age_group_genre_senior_folk': 'float64', 'age_group_genre_senior_hip_hop': 'float64', 'age_group_genre_senior_jazz': 'float64', 'age_group_genre_senior_latin': 'float64', 'age_group_genre_senior_other': 'float64', 'age_group_genre_senior_pop': 'float64', 'age_group_genre_senior_rb_soul': 'float64', 'age_group_genre_senior_rock': 'float64', 'age_group_genre_senior_unknown': 'float64', 'age_group_genre_teen_classical': 'float64', 'age_group_genre_teen_country': 'float64', 'age_group_genre_teen_electronic': 'float64', 'age_group_genre_teen_folk': 'float64', 'age_group_genre_teen_hip_hop': 'float64', 'age_group_genre_teen_jazz': 'float64', 'age_group_genre_teen_latin': 'float64', 'age_group_genre_teen_other': 'float64', 'age_group_genre_teen_pop': 'float64', 'age_group_genre_teen_rb_soul': 'float64', 'age_group_genre_teen_rock': 'float64', 'age_group_genre_teen_unknown': 'float64', 'age_group_genre_young_adult_classical': 'float64', 'age_group_genre_young_adult_country': 'float64', 'age_group_genre_young_adult_electronic': 'float64', 'age_group_genre_young_adult_folk': 'float64', 'age_group_genre_young_adult_hip_hop': 'float64', 'age_group_genre_young_adult_jazz': 'float64', 'age_group_genre_young_adult_latin': 'float64', 'age_group_genre_young_adult_other': 'float64', 'age_group_genre_young_adult_pop': 'float64', 'age_group_genre_young_adult_rb_soul': 'float64', 'age_group_genre_young_adult_rock': 'float64', 'age_group_genre_young_adult_unknown': 'float64', 'age_group_middle_aged': 'float64', 'age_group_senior': 'float64', 'age_group_teen': 'float64', 'age_group_young_adult': 'float64', 'avg_acousticness': 'float64', 'avg_danceability': 'float64', 'avg_energy': 'float64', 'avg_instrumentalness': 'float64', 'avg_key': 'float64', 'avg_liveness': 'float64', 'avg_loudness': 'float64', 'avg_mode': 'float64', 'avg_speechiness': 'float64', 'avg_tempo': 'float64', 'avg_time_signature': 'float64', 'avg_valence': 'float64', 'country_Argentina': 'float64', 'country_Australia': 'float64', 'country_Brazil': 'float64', 'country_Canada': 'float64', 'country_Chile': 'float64', 'country_Colombia': 'float64', 'country_France': 'float64', 'country_Germany': 'float64', 'country_India': 'float64', 'country_Italy': 'float64', 'country_Japan': 'float64', 'country_Mexico': 'float64', 'country_Netherlands': 'float64', 'country_Poland': 'float64', 'country_South Africa': 'float64', 'country_South Korea': 'float64', 'country_Spain': 'float64', 'country_Sweden': 'float64', 'country_UAE': 'float64', 'country_UK': 'float64', 'country_USA': 'float64', 'gender_Female': 'float64', 'gender_Male': 'float64', 'genre_diversity': 'float64', 'listening_depth': 'float64', 'monthly_hours': 'float64', 'top_genre_classical': 'float64', 'top_genre_country': 'float64', 'top_genre_electronic': 'float64', 'top_genre_folk': 'float64', 'top_genre_hip_hop': 'float64', 'top_genre_jazz': 'float64', 'top_genre_latin': 'float64', 'top_genre_other': 'float64', 'top_genre_pop': 'float64', 'top_genre_rb_soul': 'float64', 'top_genre_rock': 'float64', 'top_genre_unknown': 'float64'}}
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Item features in manifest: {'columns': ['instrumentalness', 'time_signature', 'key', 'tempo', 'loudness', 'mode', 'danceability', 'acousticness', 'liveness', 'energy', 'valence', 'speechiness', 'main_genre_classical', 'main_genre_country', 'main_genre_electronic', 'main_genre_folk', 'main_genre_hip_hop', 'main_genre_jazz', 'main_genre_latin', 'main_genre_other', 'main_genre_pop', 'main_genre_rb_soul', 'main_genre_rock', 'main_genre_unknown', 'year', 'song_age', 'is_recent', 'duration_ms', 'duration_min', 'energy_loudness', 'energy_loudness_ratio', 'valence_danceability', 'valence_danceability_diff', 'danceability_diff', 'danceability_abs_diff', 'energy_diff', 'energy_abs_diff', 'key_diff', 'key_abs_diff', 'loudness_diff', 'loudness_abs_diff', 'mode_diff', 'mode_abs_diff', 'speechiness_diff', 'speechiness_abs_diff', 'acousticness_diff', 'acousticness_abs_diff', 'instrumentalness_diff', 'instrumentalness_abs_diff', 'liveness_diff', 'liveness_abs_diff', 'valence_diff', 'valence_abs_diff', 'tempo_diff', 'tempo_abs_diff', 'time_signature_diff', 'time_signature_abs_diff', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad'], 'dimension': 65, 'types': {'acousticness': 'float64', 'acousticness_abs_diff': 'float64', 'acousticness_diff': 'float64', 'danceability': 'float64', 'danceability_abs_diff': 'float64', 'danceability_diff': 'float64', 'duration_category_long': 'float64', 'duration_category_medium': 'float64', 'duration_category_short': 'float64', 'duration_category_very_long': 'float64', 'duration_min': 'float64', 'duration_ms': 'float64', 'energy': 'float64', 'energy_abs_diff': 'float64', 'energy_diff': 'float64', 'energy_loudness': 'float64', 'energy_loudness_ratio': 'float64', 'instrumentalness': 'float64', 'instrumentalness_abs_diff': 'float64', 'instrumentalness_diff': 'float64', 'is_recent': 'int32', 'key': 'float64', 'key_abs_diff': 'float64', 'key_diff': 'float64', 'liveness': 'float64', 'liveness_abs_diff': 'float64', 'liveness_diff': 'float64', 'loudness': 'float64', 'loudness_abs_diff': 'float64', 'loudness_diff': 'float64', 'main_genre_classical': 'float64', 'main_genre_country': 'float64', 'main_genre_electronic': 'float64', 'main_genre_folk': 'float64', 'main_genre_hip_hop': 'float64', 'main_genre_jazz': 'float64', 'main_genre_latin': 'float64', 'main_genre_other': 'float64', 'main_genre_pop': 'float64', 'main_genre_rb_soul': 'float64', 'main_genre_rock': 'float64', 'main_genre_unknown': 'float64', 'mode': 'float64', 'mode_abs_diff': 'float64', 'mode_diff': 'float64', 'mood_category_angry': 'float64', 'mood_category_happy': 'float64', 'mood_category_peaceful': 'float64', 'mood_category_sad': 'float64', 'song_age': 'float64', 'speechiness': 'float64', 'speechiness_abs_diff': 'float64', 'speechiness_diff': 'float64', 'tempo': 'float64', 'tempo_abs_diff': 'float64', 'tempo_diff': 'float64', 'time_signature': 'float64', 'time_signature_abs_diff': 'float64', 'time_signature_diff': 'float64', 'valence': 'float64', 'valence_abs_diff': 'float64', 'valence_danceability': 'float64', 'valence_danceability_diff': 'float64', 'valence_diff': 'float64', 'year': 'float64'}}
2025-04-01 10:21:15,558 - recommendation_generator - INFO - ================================================================================

2025-04-01 10:21:15,558 - recommendation_generator - INFO - Recommendation engine initialized with 4818 users and 1415 items
2025-04-01 10:21:15,558 - recommendation_generator - INFO - User ID field: user_id, Item ID field: track_id
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Recommendation engine created successfully
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Generating recommendations for user 290...
2025-04-01 10:21:15,558 - recommendation_generator - INFO - 
================================================================================
2025-04-01 10:21:15,558 - recommendation_generator - INFO - PREDICTION REQUEST FOR USER 290
2025-04-01 10:21:15,558 - recommendation_generator - INFO - ================================================================================
2025-04-01 10:21:15,558 - recommendation_generator - INFO - Request details: user_id=290, top_k=10, exclude_items_count=0
2025-04-01 10:21:15,569 - recommendation_generator - INFO - Found user 290 in user features
2025-04-01 10:21:15,574 - recommendation_generator - DEBUG - User data: 
           age  monthly_hours  genre_diversity  avg_danceability  avg_energy   avg_key  avg_loudness  avg_mode  avg_speechiness  avg_acousticness  avg_instrumentalness  avg_liveness  avg_valence  avg_tempo  avg_time_signature  listening_depth  age_group_adult  age_group_middle_aged  age_group_senior  age_group_teen  age_group_young_adult  age_group_genre_adult_classical  age_group_genre_adult_country  age_group_genre_adult_electronic  age_group_genre_adult_folk  age_group_genre_adult_hip_hop  age_group_genre_adult_jazz  age_group_genre_adult_latin  age_group_genre_adult_other  age_group_genre_adult_pop  age_group_genre_adult_rb_soul  age_group_genre_adult_rock  age_group_genre_adult_unknown  age_group_genre_middle_aged_classical  age_group_genre_middle_aged_country  age_group_genre_middle_aged_electronic  age_group_genre_middle_aged_folk  age_group_genre_middle_aged_hip_hop  age_group_genre_middle_aged_jazz  age_group_genre_middle_aged_latin  age_group_genre_middle_aged_other  age_group_genre_middle_aged_pop  age_group_genre_middle_aged_rb_soul  age_group_genre_middle_aged_rock  age_group_genre_middle_aged_unknown  age_group_genre_senior_classical  age_group_genre_senior_country  age_group_genre_senior_electronic  age_group_genre_senior_folk  age_group_genre_senior_hip_hop  age_group_genre_senior_jazz  age_group_genre_senior_latin  age_group_genre_senior_other  age_group_genre_senior_pop  age_group_genre_senior_rb_soul  age_group_genre_senior_rock  age_group_genre_senior_unknown  age_group_genre_teen_classical  age_group_genre_teen_country  age_group_genre_teen_electronic  age_group_genre_teen_folk  age_group_genre_teen_hip_hop  age_group_genre_teen_jazz  age_group_genre_teen_latin  age_group_genre_teen_other  age_group_genre_teen_pop  age_group_genre_teen_rb_soul  age_group_genre_teen_rock  age_group_genre_teen_unknown  age_group_genre_young_adult_classical  age_group_genre_young_adult_country  age_group_genre_young_adult_electronic  age_group_genre_young_adult_folk  age_group_genre_young_adult_hip_hop  age_group_genre_young_adult_jazz  age_group_genre_young_adult_latin  age_group_genre_young_adult_other  age_group_genre_young_adult_pop  age_group_genre_young_adult_rb_soul  age_group_genre_young_adult_rock  age_group_genre_young_adult_unknown  user_id
4003  0.553178      -1.538306         0.026288          0.699127     0.08885 -0.623489      0.677774  0.476612         0.622237         -1.271638             -0.175334     -0.844433     0.272496  -0.630828            0.751359        -1.117486              0.0                    1.0               0.0             0.0                    0.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0      290
2025-04-01 10:21:15,638 - recommendation_generator - DEBUG - 
================================================================================
2025-04-01 10:21:15,638 - recommendation_generator - DEBUG - FEATURE PREPARATION - INPUT
2025-04-01 10:21:15,638 - recommendation_generator - DEBUG - ================================================================================
2025-04-01 10:21:15,638 - recommendation_generator - DEBUG - User features shape: (1, 82)
2025-04-01 10:21:15,654 - recommendation_generator - DEBUG - User features full data:
           age  monthly_hours  genre_diversity  avg_danceability  avg_energy   avg_key  avg_loudness  avg_mode  avg_speechiness  avg_acousticness  avg_instrumentalness  avg_liveness  avg_valence  avg_tempo  avg_time_signature  listening_depth  age_group_adult  age_group_middle_aged  age_group_senior  age_group_teen  age_group_young_adult  age_group_genre_adult_classical  age_group_genre_adult_country  age_group_genre_adult_electronic  age_group_genre_adult_folk  age_group_genre_adult_hip_hop  age_group_genre_adult_jazz  age_group_genre_adult_latin  age_group_genre_adult_other  age_group_genre_adult_pop  age_group_genre_adult_rb_soul  age_group_genre_adult_rock  age_group_genre_adult_unknown  age_group_genre_middle_aged_classical  age_group_genre_middle_aged_country  age_group_genre_middle_aged_electronic  age_group_genre_middle_aged_folk  age_group_genre_middle_aged_hip_hop  age_group_genre_middle_aged_jazz  age_group_genre_middle_aged_latin  age_group_genre_middle_aged_other  age_group_genre_middle_aged_pop  age_group_genre_middle_aged_rb_soul  age_group_genre_middle_aged_rock  age_group_genre_middle_aged_unknown  age_group_genre_senior_classical  age_group_genre_senior_country  age_group_genre_senior_electronic  age_group_genre_senior_folk  age_group_genre_senior_hip_hop  age_group_genre_senior_jazz  age_group_genre_senior_latin  age_group_genre_senior_other  age_group_genre_senior_pop  age_group_genre_senior_rb_soul  age_group_genre_senior_rock  age_group_genre_senior_unknown  age_group_genre_teen_classical  age_group_genre_teen_country  age_group_genre_teen_electronic  age_group_genre_teen_folk  age_group_genre_teen_hip_hop  age_group_genre_teen_jazz  age_group_genre_teen_latin  age_group_genre_teen_other  age_group_genre_teen_pop  age_group_genre_teen_rb_soul  age_group_genre_teen_rock  age_group_genre_teen_unknown  age_group_genre_young_adult_classical  age_group_genre_young_adult_country  age_group_genre_young_adult_electronic  age_group_genre_young_adult_folk  age_group_genre_young_adult_hip_hop  age_group_genre_young_adult_jazz  age_group_genre_young_adult_latin  age_group_genre_young_adult_other  age_group_genre_young_adult_pop  age_group_genre_young_adult_rb_soul  age_group_genre_young_adult_rock  age_group_genre_young_adult_unknown  user_id
4003  0.553178      -1.538306         0.026288          0.699127     0.08885 -0.623489      0.677774  0.476612         0.622237         -1.271638             -0.175334     -0.844433     0.272496  -0.630828            0.751359        -1.117486              0.0                    1.0               0.0             0.0                    0.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0      290
2025-04-01 10:21:15,654 - recommendation_generator - DEBUG - No item features provided, using all item features
2025-04-01 10:21:15,654 - recommendation_generator - DEBUG - ================================================================================

2025-04-01 10:21:15,654 - recommendation_generator - DEBUG - Using model's align_features method for feature alignment
2025-04-01 10:21:15,654 - recommendation_generator - DEBUG - 
================================================================================
2025-04-01 10:21:15,654 - recommendation_generator - DEBUG - RAW TENSORS BEFORE ALIGNMENT
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - ================================================================================
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - User tensor keys: ['age', 'monthly_hours', 'genre_diversity', 'avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature', 'listening_depth', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'user_id']
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - age: shape=torch.Size([1]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - monthly_hours: shape=torch.Size([1]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - genre_diversity: shape=torch.Size([1]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - Item tensor keys: ['year', 'duration_ms', 'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature', 'duration_ms.1', 'song_age', 'duration_min', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad', 'track_id']
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - year: shape=torch.Size([1415]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - duration_ms: shape=torch.Size([1415]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - danceability: shape=torch.Size([1415]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - ================================================================================

2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - 
================================================================================
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - ALIGNED TENSORS AFTER ALIGNMENT
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - ================================================================================
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG - Aligned user tensor keys: ['monthly_hours', 'genre_diversity', 'avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature', 'listening_depth', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'user_id', 'country_Argentina', 'country_Australia', 'country_Brazil', 'country_Canada', 'country_Chile', 'country_Colombia', 'country_France', 'country_Germany', 'country_India', 'country_Italy', 'country_Japan', 'country_Mexico', 'country_Netherlands', 'country_Poland', 'country_South Africa', 'country_South Korea', 'country_Spain', 'country_Sweden', 'country_UAE', 'country_UK', 'country_USA', 'gender_Female', 'gender_Male', 'top_genre_classical', 'top_genre_country', 'top_genre_electronic', 'top_genre_folk', 'top_genre_hip_hop', 'top_genre_jazz', 'top_genre_latin', 'top_genre_other', 'top_genre_pop', 'top_genre_rb_soul', 'top_genre_rock', 'top_genre_unknown']
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - monthly_hours: shape=torch.Size([1]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - genre_diversity: shape=torch.Size([1]), dtype=torch.float32
2025-04-01 10:21:15,669 - recommendation_generator - DEBUG -   - avg_danceability: shape=torch.Size([1]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - Aligned item tensor keys: ['year', 'duration_ms', 'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature', 'song_age', 'duration_min', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad', 'track_id', 'main_genre_classical', 'main_genre_country', 'main_genre_electronic', 'main_genre_folk', 'main_genre_hip_hop', 'main_genre_jazz', 'main_genre_latin', 'main_genre_other', 'main_genre_pop', 'main_genre_rb_soul', 'main_genre_rock', 'main_genre_unknown', 'is_recent', 'energy_loudness', 'energy_loudness_ratio', 'valence_danceability', 'valence_danceability_diff', 'danceability_diff', 'danceability_abs_diff', 'energy_diff', 'energy_abs_diff', 'key_diff', 'key_abs_diff', 'loudness_diff', 'loudness_abs_diff', 'mode_diff', 'mode_abs_diff', 'speechiness_diff', 'speechiness_abs_diff', 'acousticness_diff', 'acousticness_abs_diff', 'instrumentalness_diff', 'instrumentalness_abs_diff', 'liveness_diff', 'liveness_abs_diff', 'valence_diff', 'valence_abs_diff', 'tempo_diff', 'tempo_abs_diff', 'time_signature_diff', 'time_signature_abs_diff']
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG -   - year: shape=torch.Size([1415]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG -   - duration_ms: shape=torch.Size([1415]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG -   - danceability: shape=torch.Size([1415]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - ================================================================================

2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - Feature alignment completed. User features: 116, Item features: 66
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - Processing predictions in 15 chunks of 100 items
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - Processing chunk 1/15: items 0 to 100
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - 
================================================================================
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - MODEL INPUT TENSOR SHAPES
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - ================================================================================
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'monthly_hours': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'genre_diversity': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_danceability': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_energy': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_key': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_loudness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_mode': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_speechiness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_acousticness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_instrumentalness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_liveness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_valence': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_tempo': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'avg_time_signature': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'listening_depth': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_adult': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_middle_aged': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_senior': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_teen': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_young_adult': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_classical': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_country': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_electronic': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_folk': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_hip_hop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_jazz': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_latin': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_other': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_pop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_rb_soul': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_rock': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_adult_unknown': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_classical': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_country': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_electronic': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_folk': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_hip_hop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_jazz': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_latin': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_other': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_pop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_rb_soul': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_rock': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_middle_aged_unknown': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_classical': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_country': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_electronic': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_folk': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_hip_hop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_jazz': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_latin': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_other': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_pop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_rb_soul': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_rock': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_senior_unknown': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_classical': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_country': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_electronic': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_folk': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_hip_hop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_jazz': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_latin': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_other': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_pop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_rb_soul': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_rock': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_teen_unknown': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_classical': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_country': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_electronic': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_folk': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_hip_hop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_jazz': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_latin': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_other': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_pop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_rb_soul': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_rock': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'age_group_genre_young_adult_unknown': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'user_id': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Argentina': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Australia': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Brazil': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Canada': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Chile': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Colombia': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_France': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Germany': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_India': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,685 - recommendation_generator - DEBUG - User tensor 'country_Italy': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_Japan': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_Mexico': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_Netherlands': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_Poland': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_South Africa': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_South Korea': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_Spain': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_Sweden': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_UAE': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_UK': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'country_USA': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'gender_Female': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'gender_Male': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_classical': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_country': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_electronic': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_folk': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_hip_hop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_jazz': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_latin': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_other': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_pop': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_rb_soul': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_rock': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - User tensor 'top_genre_unknown': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'year': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'duration_ms': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'danceability': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'energy': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'key': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'loudness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'mode': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'speechiness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'acousticness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'instrumentalness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'liveness': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'valence': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'tempo': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'time_signature': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'song_age': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'duration_min': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'duration_category_long': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'duration_category_medium': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'duration_category_short': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'duration_category_very_long': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'mood_category_angry': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'mood_category_happy': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'mood_category_peaceful': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'mood_category_sad': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'track_id': shape=torch.Size([100]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_classical': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_country': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_electronic': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_folk': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_hip_hop': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_jazz': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_latin': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_other': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_pop': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_rb_soul': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_rock': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'main_genre_unknown': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'is_recent': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'energy_loudness': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'energy_loudness_ratio': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'valence_danceability': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'valence_danceability_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'danceability_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'danceability_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'energy_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'energy_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'key_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'key_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'loudness_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'loudness_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'mode_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'mode_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'speechiness_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'speechiness_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'acousticness_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'acousticness_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'instrumentalness_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'instrumentalness_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'liveness_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'liveness_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'valence_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'valence_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'tempo_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'tempo_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'time_signature_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - Item tensor 'time_signature_abs_diff': shape=torch.Size([100, 1]), dtype=torch.float32
2025-04-01 10:21:15,701 - recommendation_generator - DEBUG - ================================================================================

2025-04-01 10:21:15,717 - recommendation_generator - ERROR - Error in chunk 0/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,717 - recommendation_generator - DEBUG - Processing chunk 2/15: items 100 to 200
2025-04-01 10:21:15,717 - recommendation_generator - ERROR - Error in chunk 1/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,717 - recommendation_generator - DEBUG - Processing chunk 3/15: items 200 to 300
2025-04-01 10:21:15,717 - recommendation_generator - ERROR - Error in chunk 2/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,717 - recommendation_generator - DEBUG - Processing chunk 4/15: items 300 to 400
2025-04-01 10:21:15,717 - recommendation_generator - ERROR - Error in chunk 3/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,733 - recommendation_generator - DEBUG - Processing chunk 5/15: items 400 to 500
2025-04-01 10:21:15,733 - recommendation_generator - ERROR - Error in chunk 4/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,733 - recommendation_generator - DEBUG - Processing chunk 6/15: items 500 to 600
2025-04-01 10:21:15,733 - recommendation_generator - ERROR - Error in chunk 5/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,733 - recommendation_generator - DEBUG - Processing chunk 7/15: items 600 to 700
2025-04-01 10:21:15,733 - recommendation_generator - ERROR - Error in chunk 6/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,733 - recommendation_generator - DEBUG - Processing chunk 8/15: items 700 to 800
2025-04-01 10:21:15,733 - recommendation_generator - ERROR - Error in chunk 7/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,733 - recommendation_generator - DEBUG - Processing chunk 9/15: items 800 to 900
2025-04-01 10:21:15,733 - recommendation_generator - ERROR - Error in chunk 8/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,733 - recommendation_generator - DEBUG - Processing chunk 10/15: items 900 to 1000
2025-04-01 10:21:15,733 - recommendation_generator - ERROR - Error in chunk 9/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,733 - recommendation_generator - DEBUG - Processing chunk 11/15: items 1000 to 1100
2025-04-01 10:21:15,748 - recommendation_generator - ERROR - Error in chunk 10/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,748 - recommendation_generator - DEBUG - Processing chunk 12/15: items 1100 to 1200
2025-04-01 10:21:15,748 - recommendation_generator - ERROR - Error in chunk 11/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,748 - recommendation_generator - DEBUG - Processing chunk 13/15: items 1200 to 1300
2025-04-01 10:21:15,748 - recommendation_generator - ERROR - Error in chunk 12/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,748 - recommendation_generator - DEBUG - Processing chunk 14/15: items 1300 to 1400
2025-04-01 10:21:15,748 - recommendation_generator - ERROR - Error in chunk 13/15: mat1 and mat2 shapes cannot be multiplied (1x11600 and 81x128)
2025-04-01 10:21:15,748 - recommendation_generator - DEBUG - Processing chunk 15/15: items 1400 to 1415
2025-04-01 10:21:15,748 - recommendation_generator - ERROR - Error in chunk 14/15: mat1 and mat2 shapes cannot be multiplied (1x1740 and 81x128)
2025-04-01 10:21:15,748 - recommendation_generator - INFO - 
================================================================================
2025-04-01 10:21:15,748 - recommendation_generator - INFO - RECOMMENDATION RESULTS
2025-04-01 10:21:15,748 - recommendation_generator - INFO - ================================================================================
2025-04-01 10:21:15,748 - recommendation_generator - INFO - Generated 10 recommendations for user 290
2025-04-01 10:21:15,748 - recommendation_generator - INFO - Top 5 recommendations:
  user_id  item_id  score  rank
0     290       20    0.0     1
1     290      251    0.0     2
2     290     1323    0.0     3
3     290      499    0.0     4
4     290      514    0.0     5
2025-04-01 10:21:15,748 - recommendation_generator - INFO - ================================================================================

2025-04-01 10:21:15,765 - recommendation_generator - INFO - Saved 10 recommendations to recommendations/user290_recommendations.csv
2025-04-01 10:21:15,765 - recommendation_generator - INFO - 
Sample recommendations:
2025-04-01 10:21:15,765 - recommendation_generator - INFO -   user_id  item_id  score  rank
0     290       20    0.0     1
1     290      251    0.0     2
2     290     1323    0.0     3
3     290      499    0.0     4
4     290      514    0.0     5
2025-04-01 10:21:15,765 - recommendation_generator - INFO - 
####################################################################################################
2025-04-01 10:21:15,765 - recommendation_generator - INFO - RECOMMENDATION GENERATION COMPLETED
2025-04-01 10:21:15,765 - recommendation_generator - INFO - ####################################################################################################
