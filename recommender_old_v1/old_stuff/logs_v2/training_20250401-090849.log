2025-04-01 09:08:49,459 - root - INFO - Logging setup complete. Log file: logs\training_20250401-090849.log
2025-04-01 09:08:49,459 - root - INFO - 
####################################################################################################
2025-04-01 09:08:49,459 - root - INFO - LHYDRA MUSIC RECOMMENDER - DETAILED TRAINING DEBUG INFORMATION
2025-04-01 09:08:49,459 - root - INFO - ####################################################################################################

2025-04-01 09:08:49,459 - root - INFO - ================================================================================
2025-04-01 09:08:49,459 - root - INFO - CONFIGURATION SUMMARY
2025-04-01 09:08:49,459 - root - INFO - ================================================================================
2025-04-01 09:08:49,459 - root - INFO - Data config: {'target_column': 'high_engagement', 'train_path': 'notebooks/shipping_10k_data/train_data.csv', 'preprocessed_data_dir': 'notebooks/shipping_10k_data', 'user_features_path': 'notebooks/shipping_10k_data/features/user_features.csv', 'item_features_path': 'notebooks/shipping_10k_data/features/item_features.csv', 'feature_manifest_path': 'notebooks/shipping_10k_data/feature_manifest.yaml', 'output_dir': 'notebooks/shipping_10k_data', 'user_demographic_features': ['age', 'gender', 'country'], 'user_listening_features': ['monthly_hours', 'genre_diversity', 'top_genre'], 'user_audio_preferences': ['avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature'], 'track_metadata_features': ['artist', 'main_genre', 'year', 'duration_ms'], 'track_audio_features': ['danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature'], 'categorical_features': ['gender', 'country', 'top_genre', 'main_genre', 'artist'], 'numerical_features': ['age', 'monthly_hours', 'genre_diversity', 'year', 'duration_ms'], 'target_threshold': 5, 'test_size': 0.2, 'validation_size': 0.1, 'random_seed': 42, 'embedding_dim': 32}
2025-04-01 09:08:49,459 - root - INFO - Model config: {'embedding_dim': 32, 'hidden_dims': [128, 64], 'prediction_dims': [64, 32], 'dropout': 0.2, 'final_layer_size': 16, 'user_tower': {'hidden_layers': [128, 64], 'dropout': 0.2, 'activation': 'relu'}, 'item_tower': {'hidden_layers': [128, 64], 'dropout': 0.2, 'activation': 'relu'}}
2025-04-01 09:08:49,459 - root - INFO - Training config: {'learning_rate': 0.001, 'weight_decay': '1e-4', 'num_epochs': 100, 'patience': 10, 'batch_size': 64, 'num_workers': 4, 'checkpoint_dir': 'models/checkpoints', 'log_dir': 'logs', 'optimizer': 'adam', 'loss_function': 'binary_cross_entropy', 'lr_scheduler': {'use': True, 'factor': 0.5, 'patience': 5}, 'early_stopping_patience': 10}
2025-04-01 09:08:49,459 - root - INFO - Evaluation config: {'k_values': [5, 10, 20], 'save_predictions': True, 'save_metrics': True, 'cohort_analysis': True, 'metrics_dir': 'evaluation/metrics', 'predictions_dir': 'evaluation/predictions'}
2025-04-01 09:08:49,459 - root - INFO - ================================================================================

2025-04-01 09:08:49,459 - root - INFO - Using device: cpu
2025-04-01 09:08:49,459 - root - INFO - Using preprocessed data from notebooks/shipping_10k_data
2025-04-01 09:08:50,851 - utils.data_utils - INFO - Loaded preprocessor from notebooks/shipping_10k_data\preprocessor.joblib
2025-04-01 09:08:50,851 - utils.data_utils - INFO - Loaded preprocessed data: train=7000, val=1000, test=2000
2025-04-01 09:08:50,901 - utils.data_utils - INFO - Found 4818 unique users in interactions
2025-04-01 09:08:50,918 - utils.data_utils - INFO - Created user features dataframe with 4818 users and 82 features
2025-04-01 09:08:50,918 - utils.data_utils - INFO - Found 1415 unique items in interactions
2025-04-01 09:08:50,918 - utils.data_utils - INFO - Created item features dataframe with 1415 items and 26 features
2025-04-01 09:08:50,918 - utils.data_utils - INFO - Copied 'high_engagement' column to 'engagement' for compatibility
2025-04-01 09:08:51,167 - utils.data_utils - INFO - Saved user features to notebooks/shipping_10k_data\features\user_features.csv
2025-04-01 09:08:51,217 - utils.data_utils - INFO - Saved item features to notebooks/shipping_10k_data\features\item_features.csv
2025-04-01 09:08:51,217 - utils.data_utils - INFO - Saved feature files to notebooks/shipping_10k_data\features
2025-04-01 09:08:51,217 - root - INFO - Data split: train=7000, val=1000, test=2000
2025-04-01 09:08:51,217 - utils.data_utils - INFO - 
================================================================================
2025-04-01 09:08:51,217 - utils.data_utils - INFO - DATASET INITIALIZATION - DETAILED INFORMATION
2025-04-01 09:08:51,217 - utils.data_utils - INFO - ================================================================================
2025-04-01 09:08:51,217 - utils.data_utils - INFO - Interactions DataFrame shape: (7000, 1178)
2025-04-01 09:08:51,235 - utils.data_utils - INFO - Sample interaction: User ID=3954.0, Track ID=20.0, Target=1.0
2025-04-01 09:08:51,235 - utils.data_utils - INFO - 
User Features DataFrame shape: (4818, 82)
2025-04-01 09:08:51,235 - utils.data_utils - INFO - User Features DataFrame columns: ['age', 'monthly_hours', 'genre_diversity', 'avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature', 'listening_depth', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'user_id']
2025-04-01 09:08:51,235 - utils.data_utils - INFO - User Features DataFrame dtypes:
age                                    float64
monthly_hours                          float64
genre_diversity                        float64
avg_danceability                       float64
avg_energy                             float64
                                        ...   
age_group_genre_young_adult_pop        float64
age_group_genre_young_adult_rb_soul    float64
age_group_genre_young_adult_rock       float64
age_group_genre_young_adult_unknown    float64
user_id                                  int64
Length: 82, dtype: object
2025-04-01 09:08:51,251 - utils.data_utils - INFO - User Features DataFrame sample (first 3 rows):
        age  monthly_hours  genre_diversity  avg_danceability  avg_energy   avg_key  avg_loudness  avg_mode  avg_speechiness  avg_acousticness  avg_instrumentalness  avg_liveness  avg_valence  avg_tempo  avg_time_signature  listening_depth  age_group_adult  age_group_middle_aged  age_group_senior  age_group_teen  age_group_young_adult  age_group_genre_adult_classical  age_group_genre_adult_country  age_group_genre_adult_electronic  age_group_genre_adult_folk  age_group_genre_adult_hip_hop  age_group_genre_adult_jazz  age_group_genre_adult_latin  age_group_genre_adult_other  age_group_genre_adult_pop  age_group_genre_adult_rb_soul  age_group_genre_adult_rock  age_group_genre_adult_unknown  age_group_genre_middle_aged_classical  age_group_genre_middle_aged_country  age_group_genre_middle_aged_electronic  age_group_genre_middle_aged_folk  age_group_genre_middle_aged_hip_hop  age_group_genre_middle_aged_jazz  age_group_genre_middle_aged_latin  age_group_genre_middle_aged_other  age_group_genre_middle_aged_pop  age_group_genre_middle_aged_rb_soul  age_group_genre_middle_aged_rock  age_group_genre_middle_aged_unknown  age_group_genre_senior_classical  age_group_genre_senior_country  age_group_genre_senior_electronic  age_group_genre_senior_folk  age_group_genre_senior_hip_hop  age_group_genre_senior_jazz  age_group_genre_senior_latin  age_group_genre_senior_other  age_group_genre_senior_pop  age_group_genre_senior_rb_soul  age_group_genre_senior_rock  age_group_genre_senior_unknown  age_group_genre_teen_classical  age_group_genre_teen_country  age_group_genre_teen_electronic  age_group_genre_teen_folk  age_group_genre_teen_hip_hop  age_group_genre_teen_jazz  age_group_genre_teen_latin  age_group_genre_teen_other  age_group_genre_teen_pop  age_group_genre_teen_rb_soul  age_group_genre_teen_rock  age_group_genre_teen_unknown  age_group_genre_young_adult_classical  age_group_genre_young_adult_country  age_group_genre_young_adult_electronic  age_group_genre_young_adult_folk  age_group_genre_young_adult_hip_hop  age_group_genre_young_adult_jazz  age_group_genre_young_adult_latin  age_group_genre_young_adult_other  age_group_genre_young_adult_pop  age_group_genre_young_adult_rb_soul  age_group_genre_young_adult_rock  age_group_genre_young_adult_unknown  user_id
0 -1.245471       0.462032         0.820488          0.254657    0.516811 -0.638312      1.469966  1.207056         1.232577         -0.205346             -1.064706      0.718250    -0.531829   0.860737           -0.078877        -0.407109              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     3954
1 -0.979005       1.168996         0.820488         -1.021574   -0.766459 -1.452319      0.691628  0.833718        -0.814644          0.439290             -0.561167      1.136262    -0.068724  -2.514090           -3.640159        -0.082599              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     4084
2 -0.512688       0.148121         0.820488          2.121240    1.420093 -1.099048      0.461868 -0.148323         2.601773         -1.286526             -0.877375      1.080125     0.661002  -0.978833            0.751359        -0.551200              1.0                    0.0               0.0             0.0                    0.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        1.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0     3280
2025-04-01 09:08:51,251 - utils.data_utils - INFO - 
Item Features DataFrame shape: (1415, 26)
2025-04-01 09:08:51,251 - utils.data_utils - INFO - Item Features DataFrame columns: ['year', 'duration_ms', 'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature', 'duration_ms', 'song_age', 'duration_min', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad', 'track_id']
2025-04-01 09:08:51,266 - utils.data_utils - INFO - Item Features DataFrame dtypes:
year                           float64
duration_ms                    float64
danceability                   float64
energy                         float64
key                            float64
loudness                       float64
mode                           float64
speechiness                    float64
acousticness                   float64
instrumentalness               float64
liveness                       float64
valence                        float64
tempo                          float64
time_signature                 float64
duration_ms                    float64
song_age                       float64
duration_min                   float64
duration_category_long         float64
duration_category_medium       float64
duration_category_short        float64
duration_category_very_long    float64
mood_category_angry            float64
mood_category_happy            float64
mood_category_peaceful         float64
mood_category_sad              float64
track_id                         int64
dtype: object
2025-04-01 09:08:51,267 - utils.data_utils - INFO - Item Features DataFrame sample (first 3 rows):
       year  duration_ms  danceability    energy       key  loudness      mode  speechiness  acousticness  instrumentalness  liveness   valence     tempo  time_signature  duration_ms  song_age  duration_min  duration_category_long  duration_category_medium  duration_category_short  duration_category_very_long  mood_category_angry  mood_category_happy  mood_category_peaceful  mood_category_sad  track_id
0 -0.924737     1.354142     -0.791459  0.992329  1.084206  0.687860  0.731060    -0.472487     -0.668154         -0.539603  0.673052  0.181515  1.647526        0.289441     1.354142  0.924737      1.354142                     1.0                       0.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0        20
1  0.654984     0.446307      0.174468  0.893462 -0.669889  1.279397  0.731060    -0.509508     -0.765071         -0.493547 -0.686074 -0.802973 -0.393427        0.289441     0.446307 -0.654984      0.446307                     1.0                       0.0                      0.0                          0.0                  1.0                  0.0                     0.0                0.0      1109
2  0.497012    -0.572205      2.411351 -0.420650 -0.669889  0.391958 -1.367877    -0.013428     -0.749149         -0.521315  0.471700  0.745795 -0.670723        0.289441    -0.572205 -0.497012     -0.572205                     0.0                       1.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0       788
2025-04-01 09:08:51,267 - utils.data_utils - INFO - ================================================================================
2025-04-01 09:08:51,267 - utils.data_utils - INFO - END OF DATASET INITIALIZATION - DETAILED INFORMATION
2025-04-01 09:08:51,267 - utils.data_utils - INFO - ================================================================================

2025-04-01 09:08:51,267 - utils.data_utils - INFO - Created dataset with 7000 interactions
2025-04-01 09:08:51,267 - utils.data_utils - INFO - User features: (4818, 81), Item features: (1415, 25)
2025-04-01 09:08:51,267 - utils.data_utils - INFO - 
================================================================================
2025-04-01 09:08:51,267 - utils.data_utils - INFO - DATASET INITIALIZATION - DETAILED INFORMATION
2025-04-01 09:08:51,267 - utils.data_utils - INFO - ================================================================================
2025-04-01 09:08:51,267 - utils.data_utils - INFO - Interactions DataFrame shape: (1000, 1178)
2025-04-01 09:08:51,282 - utils.data_utils - INFO - Sample interaction: User ID=3918.0, Track ID=141.0, Target=0.0
2025-04-01 09:08:51,282 - utils.data_utils - INFO - 
User Features DataFrame shape: (4818, 82)
2025-04-01 09:08:51,282 - utils.data_utils - INFO - User Features DataFrame columns: ['age', 'monthly_hours', 'genre_diversity', 'avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature', 'listening_depth', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'user_id']
2025-04-01 09:08:51,284 - utils.data_utils - INFO - User Features DataFrame dtypes:
age                                    float64
monthly_hours                          float64
genre_diversity                        float64
avg_danceability                       float64
avg_energy                             float64
                                        ...   
age_group_genre_young_adult_pop        float64
age_group_genre_young_adult_rb_soul    float64
age_group_genre_young_adult_rock       float64
age_group_genre_young_adult_unknown    float64
user_id                                  int64
Length: 82, dtype: object
2025-04-01 09:08:51,301 - utils.data_utils - INFO - User Features DataFrame sample (first 3 rows):
        age  monthly_hours  genre_diversity  avg_danceability  avg_energy   avg_key  avg_loudness  avg_mode  avg_speechiness  avg_acousticness  avg_instrumentalness  avg_liveness  avg_valence  avg_tempo  avg_time_signature  listening_depth  age_group_adult  age_group_middle_aged  age_group_senior  age_group_teen  age_group_young_adult  age_group_genre_adult_classical  age_group_genre_adult_country  age_group_genre_adult_electronic  age_group_genre_adult_folk  age_group_genre_adult_hip_hop  age_group_genre_adult_jazz  age_group_genre_adult_latin  age_group_genre_adult_other  age_group_genre_adult_pop  age_group_genre_adult_rb_soul  age_group_genre_adult_rock  age_group_genre_adult_unknown  age_group_genre_middle_aged_classical  age_group_genre_middle_aged_country  age_group_genre_middle_aged_electronic  age_group_genre_middle_aged_folk  age_group_genre_middle_aged_hip_hop  age_group_genre_middle_aged_jazz  age_group_genre_middle_aged_latin  age_group_genre_middle_aged_other  age_group_genre_middle_aged_pop  age_group_genre_middle_aged_rb_soul  age_group_genre_middle_aged_rock  age_group_genre_middle_aged_unknown  age_group_genre_senior_classical  age_group_genre_senior_country  age_group_genre_senior_electronic  age_group_genre_senior_folk  age_group_genre_senior_hip_hop  age_group_genre_senior_jazz  age_group_genre_senior_latin  age_group_genre_senior_other  age_group_genre_senior_pop  age_group_genre_senior_rb_soul  age_group_genre_senior_rock  age_group_genre_senior_unknown  age_group_genre_teen_classical  age_group_genre_teen_country  age_group_genre_teen_electronic  age_group_genre_teen_folk  age_group_genre_teen_hip_hop  age_group_genre_teen_jazz  age_group_genre_teen_latin  age_group_genre_teen_other  age_group_genre_teen_pop  age_group_genre_teen_rb_soul  age_group_genre_teen_rock  age_group_genre_teen_unknown  age_group_genre_young_adult_classical  age_group_genre_young_adult_country  age_group_genre_young_adult_electronic  age_group_genre_young_adult_folk  age_group_genre_young_adult_hip_hop  age_group_genre_young_adult_jazz  age_group_genre_young_adult_latin  age_group_genre_young_adult_other  age_group_genre_young_adult_pop  age_group_genre_young_adult_rb_soul  age_group_genre_young_adult_rock  age_group_genre_young_adult_unknown  user_id
0 -1.245471       0.462032         0.820488          0.254657    0.516811 -0.638312      1.469966  1.207056         1.232577         -0.205346             -1.064706      0.718250    -0.531829   0.860737           -0.078877        -0.407109              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     3954
1 -0.979005       1.168996         0.820488         -1.021574   -0.766459 -1.452319      0.691628  0.833718        -0.814644          0.439290             -0.561167      1.136262    -0.068724  -2.514090           -3.640159        -0.082599              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     4084
2 -0.512688       0.148121         0.820488          2.121240    1.420093 -1.099048      0.461868 -0.148323         2.601773         -1.286526             -0.877375      1.080125     0.661002  -0.978833            0.751359        -0.551200              1.0                    0.0               0.0             0.0                    0.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        1.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0     3280
2025-04-01 09:08:51,301 - utils.data_utils - INFO - 
Item Features DataFrame shape: (1415, 26)
2025-04-01 09:08:51,301 - utils.data_utils - INFO - Item Features DataFrame columns: ['year', 'duration_ms', 'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature', 'duration_ms', 'song_age', 'duration_min', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad', 'track_id']
2025-04-01 09:08:51,301 - utils.data_utils - INFO - Item Features DataFrame dtypes:
year                           float64
duration_ms                    float64
danceability                   float64
energy                         float64
key                            float64
loudness                       float64
mode                           float64
speechiness                    float64
acousticness                   float64
instrumentalness               float64
liveness                       float64
valence                        float64
tempo                          float64
time_signature                 float64
duration_ms                    float64
song_age                       float64
duration_min                   float64
duration_category_long         float64
duration_category_medium       float64
duration_category_short        float64
duration_category_very_long    float64
mood_category_angry            float64
mood_category_happy            float64
mood_category_peaceful         float64
mood_category_sad              float64
track_id                         int64
dtype: object
2025-04-01 09:08:51,318 - utils.data_utils - INFO - Item Features DataFrame sample (first 3 rows):
       year  duration_ms  danceability    energy       key  loudness      mode  speechiness  acousticness  instrumentalness  liveness   valence     tempo  time_signature  duration_ms  song_age  duration_min  duration_category_long  duration_category_medium  duration_category_short  duration_category_very_long  mood_category_angry  mood_category_happy  mood_category_peaceful  mood_category_sad  track_id
0 -0.924737     1.354142     -0.791459  0.992329  1.084206  0.687860  0.731060    -0.472487     -0.668154         -0.539603  0.673052  0.181515  1.647526        0.289441     1.354142  0.924737      1.354142                     1.0                       0.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0        20
1  0.654984     0.446307      0.174468  0.893462 -0.669889  1.279397  0.731060    -0.509508     -0.765071         -0.493547 -0.686074 -0.802973 -0.393427        0.289441     0.446307 -0.654984      0.446307                     1.0                       0.0                      0.0                          0.0                  1.0                  0.0                     0.0                0.0      1109
2  0.497012    -0.572205      2.411351 -0.420650 -0.669889  0.391958 -1.367877    -0.013428     -0.749149         -0.521315  0.471700  0.745795 -0.670723        0.289441    -0.572205 -0.497012     -0.572205                     0.0                       1.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0       788
2025-04-01 09:08:51,318 - utils.data_utils - INFO - ================================================================================
2025-04-01 09:08:51,318 - utils.data_utils - INFO - END OF DATASET INITIALIZATION - DETAILED INFORMATION
2025-04-01 09:08:51,318 - utils.data_utils - INFO - ================================================================================

2025-04-01 09:08:51,318 - utils.data_utils - INFO - Created dataset with 1000 interactions
2025-04-01 09:08:51,318 - utils.data_utils - INFO - User features: (4818, 81), Item features: (1415, 25)
2025-04-01 09:08:51,318 - utils.data_utils - INFO - 
================================================================================
2025-04-01 09:08:51,318 - utils.data_utils - INFO - DATASET INITIALIZATION - DETAILED INFORMATION
2025-04-01 09:08:51,318 - utils.data_utils - INFO - ================================================================================
2025-04-01 09:08:51,318 - utils.data_utils - INFO - Interactions DataFrame shape: (2000, 1178)
2025-04-01 09:08:51,318 - utils.data_utils - INFO - Sample interaction: User ID=4130.0, Track ID=20.0, Target=0.0
2025-04-01 09:08:51,318 - utils.data_utils - INFO - 
User Features DataFrame shape: (4818, 82)
2025-04-01 09:08:51,318 - utils.data_utils - INFO - User Features DataFrame columns: ['age', 'monthly_hours', 'genre_diversity', 'avg_danceability', 'avg_energy', 'avg_key', 'avg_loudness', 'avg_mode', 'avg_speechiness', 'avg_acousticness', 'avg_instrumentalness', 'avg_liveness', 'avg_valence', 'avg_tempo', 'avg_time_signature', 'listening_depth', 'age_group_adult', 'age_group_middle_aged', 'age_group_senior', 'age_group_teen', 'age_group_young_adult', 'age_group_genre_adult_classical', 'age_group_genre_adult_country', 'age_group_genre_adult_electronic', 'age_group_genre_adult_folk', 'age_group_genre_adult_hip_hop', 'age_group_genre_adult_jazz', 'age_group_genre_adult_latin', 'age_group_genre_adult_other', 'age_group_genre_adult_pop', 'age_group_genre_adult_rb_soul', 'age_group_genre_adult_rock', 'age_group_genre_adult_unknown', 'age_group_genre_middle_aged_classical', 'age_group_genre_middle_aged_country', 'age_group_genre_middle_aged_electronic', 'age_group_genre_middle_aged_folk', 'age_group_genre_middle_aged_hip_hop', 'age_group_genre_middle_aged_jazz', 'age_group_genre_middle_aged_latin', 'age_group_genre_middle_aged_other', 'age_group_genre_middle_aged_pop', 'age_group_genre_middle_aged_rb_soul', 'age_group_genre_middle_aged_rock', 'age_group_genre_middle_aged_unknown', 'age_group_genre_senior_classical', 'age_group_genre_senior_country', 'age_group_genre_senior_electronic', 'age_group_genre_senior_folk', 'age_group_genre_senior_hip_hop', 'age_group_genre_senior_jazz', 'age_group_genre_senior_latin', 'age_group_genre_senior_other', 'age_group_genre_senior_pop', 'age_group_genre_senior_rb_soul', 'age_group_genre_senior_rock', 'age_group_genre_senior_unknown', 'age_group_genre_teen_classical', 'age_group_genre_teen_country', 'age_group_genre_teen_electronic', 'age_group_genre_teen_folk', 'age_group_genre_teen_hip_hop', 'age_group_genre_teen_jazz', 'age_group_genre_teen_latin', 'age_group_genre_teen_other', 'age_group_genre_teen_pop', 'age_group_genre_teen_rb_soul', 'age_group_genre_teen_rock', 'age_group_genre_teen_unknown', 'age_group_genre_young_adult_classical', 'age_group_genre_young_adult_country', 'age_group_genre_young_adult_electronic', 'age_group_genre_young_adult_folk', 'age_group_genre_young_adult_hip_hop', 'age_group_genre_young_adult_jazz', 'age_group_genre_young_adult_latin', 'age_group_genre_young_adult_other', 'age_group_genre_young_adult_pop', 'age_group_genre_young_adult_rb_soul', 'age_group_genre_young_adult_rock', 'age_group_genre_young_adult_unknown', 'user_id']
2025-04-01 09:08:51,318 - utils.data_utils - INFO - User Features DataFrame dtypes:
age                                    float64
monthly_hours                          float64
genre_diversity                        float64
avg_danceability                       float64
avg_energy                             float64
                                        ...   
age_group_genre_young_adult_pop        float64
age_group_genre_young_adult_rb_soul    float64
age_group_genre_young_adult_rock       float64
age_group_genre_young_adult_unknown    float64
user_id                                  int64
Length: 82, dtype: object
2025-04-01 09:08:51,351 - utils.data_utils - INFO - User Features DataFrame sample (first 3 rows):
        age  monthly_hours  genre_diversity  avg_danceability  avg_energy   avg_key  avg_loudness  avg_mode  avg_speechiness  avg_acousticness  avg_instrumentalness  avg_liveness  avg_valence  avg_tempo  avg_time_signature  listening_depth  age_group_adult  age_group_middle_aged  age_group_senior  age_group_teen  age_group_young_adult  age_group_genre_adult_classical  age_group_genre_adult_country  age_group_genre_adult_electronic  age_group_genre_adult_folk  age_group_genre_adult_hip_hop  age_group_genre_adult_jazz  age_group_genre_adult_latin  age_group_genre_adult_other  age_group_genre_adult_pop  age_group_genre_adult_rb_soul  age_group_genre_adult_rock  age_group_genre_adult_unknown  age_group_genre_middle_aged_classical  age_group_genre_middle_aged_country  age_group_genre_middle_aged_electronic  age_group_genre_middle_aged_folk  age_group_genre_middle_aged_hip_hop  age_group_genre_middle_aged_jazz  age_group_genre_middle_aged_latin  age_group_genre_middle_aged_other  age_group_genre_middle_aged_pop  age_group_genre_middle_aged_rb_soul  age_group_genre_middle_aged_rock  age_group_genre_middle_aged_unknown  age_group_genre_senior_classical  age_group_genre_senior_country  age_group_genre_senior_electronic  age_group_genre_senior_folk  age_group_genre_senior_hip_hop  age_group_genre_senior_jazz  age_group_genre_senior_latin  age_group_genre_senior_other  age_group_genre_senior_pop  age_group_genre_senior_rb_soul  age_group_genre_senior_rock  age_group_genre_senior_unknown  age_group_genre_teen_classical  age_group_genre_teen_country  age_group_genre_teen_electronic  age_group_genre_teen_folk  age_group_genre_teen_hip_hop  age_group_genre_teen_jazz  age_group_genre_teen_latin  age_group_genre_teen_other  age_group_genre_teen_pop  age_group_genre_teen_rb_soul  age_group_genre_teen_rock  age_group_genre_teen_unknown  age_group_genre_young_adult_classical  age_group_genre_young_adult_country  age_group_genre_young_adult_electronic  age_group_genre_young_adult_folk  age_group_genre_young_adult_hip_hop  age_group_genre_young_adult_jazz  age_group_genre_young_adult_latin  age_group_genre_young_adult_other  age_group_genre_young_adult_pop  age_group_genre_young_adult_rb_soul  age_group_genre_young_adult_rock  age_group_genre_young_adult_unknown  user_id
0 -1.245471       0.462032         0.820488          0.254657    0.516811 -0.638312      1.469966  1.207056         1.232577         -0.205346             -1.064706      0.718250    -0.531829   0.860737           -0.078877        -0.407109              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     3954
1 -0.979005       1.168996         0.820488         -1.021574   -0.766459 -1.452319      0.691628  0.833718        -0.814644          0.439290             -0.561167      1.136262    -0.068724  -2.514090           -3.640159        -0.082599              0.0                    0.0               0.0             0.0                    1.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        0.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               1.0                                  0.0     4084
2 -0.512688       0.148121         0.820488          2.121240    1.420093 -1.099048      0.461868 -0.148323         2.601773         -1.286526             -0.877375      1.080125     0.661002  -0.978833            0.751359        -0.551200              1.0                    0.0               0.0             0.0                    0.0                              0.0                            0.0                               0.0                         0.0                            0.0                         0.0                          0.0                          0.0                        1.0                            0.0                         0.0                            0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0                               0.0                             0.0                                0.0                          0.0                             0.0                          0.0                           0.0                           0.0                         0.0                             0.0                          0.0                             0.0                             0.0                           0.0                              0.0                        0.0                           0.0                        0.0                         0.0                         0.0                       0.0                           0.0                        0.0                           0.0                                    0.0                                  0.0                                     0.0                               0.0                                  0.0                               0.0                                0.0                                0.0                              0.0                                  0.0                               0.0                                  0.0     3280
2025-04-01 09:08:51,351 - utils.data_utils - INFO - 
Item Features DataFrame shape: (1415, 26)
2025-04-01 09:08:51,351 - utils.data_utils - INFO - Item Features DataFrame columns: ['year', 'duration_ms', 'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo', 'time_signature', 'duration_ms', 'song_age', 'duration_min', 'duration_category_long', 'duration_category_medium', 'duration_category_short', 'duration_category_very_long', 'mood_category_angry', 'mood_category_happy', 'mood_category_peaceful', 'mood_category_sad', 'track_id']
2025-04-01 09:08:51,351 - utils.data_utils - INFO - Item Features DataFrame dtypes:
year                           float64
duration_ms                    float64
danceability                   float64
energy                         float64
key                            float64
loudness                       float64
mode                           float64
speechiness                    float64
acousticness                   float64
instrumentalness               float64
liveness                       float64
valence                        float64
tempo                          float64
time_signature                 float64
duration_ms                    float64
song_age                       float64
duration_min                   float64
duration_category_long         float64
duration_category_medium       float64
duration_category_short        float64
duration_category_very_long    float64
mood_category_angry            float64
mood_category_happy            float64
mood_category_peaceful         float64
mood_category_sad              float64
track_id                         int64
dtype: object
2025-04-01 09:08:51,351 - utils.data_utils - INFO - Item Features DataFrame sample (first 3 rows):
       year  duration_ms  danceability    energy       key  loudness      mode  speechiness  acousticness  instrumentalness  liveness   valence     tempo  time_signature  duration_ms  song_age  duration_min  duration_category_long  duration_category_medium  duration_category_short  duration_category_very_long  mood_category_angry  mood_category_happy  mood_category_peaceful  mood_category_sad  track_id
0 -0.924737     1.354142     -0.791459  0.992329  1.084206  0.687860  0.731060    -0.472487     -0.668154         -0.539603  0.673052  0.181515  1.647526        0.289441     1.354142  0.924737      1.354142                     1.0                       0.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0        20
1  0.654984     0.446307      0.174468  0.893462 -0.669889  1.279397  0.731060    -0.509508     -0.765071         -0.493547 -0.686074 -0.802973 -0.393427        0.289441     0.446307 -0.654984      0.446307                     1.0                       0.0                      0.0                          0.0                  1.0                  0.0                     0.0                0.0      1109
2  0.497012    -0.572205      2.411351 -0.420650 -0.669889  0.391958 -1.367877    -0.013428     -0.749149         -0.521315  0.471700  0.745795 -0.670723        0.289441    -0.572205 -0.497012     -0.572205                     0.0                       1.0                      0.0                          0.0                  0.0                  1.0                     0.0                0.0       788
2025-04-01 09:08:51,351 - utils.data_utils - INFO - ================================================================================
2025-04-01 09:08:51,351 - utils.data_utils - INFO - END OF DATASET INITIALIZATION - DETAILED INFORMATION
2025-04-01 09:08:51,351 - utils.data_utils - INFO - ================================================================================

2025-04-01 09:08:51,366 - utils.data_utils - INFO - Created dataset with 2000 interactions
2025-04-01 09:08:51,366 - utils.data_utils - INFO - User features: (4818, 81), Item features: (1415, 25)
2025-04-01 09:08:51,368 - utils.data_utils - INFO - Created data loaders with batch size 64
2025-04-01 09:08:51,368 - root - INFO - Initializing model...
2025-04-01 09:08:51,368 - root - INFO - Feature dimensions: user=81, item=25
2025-04-01 09:08:51,368 - root - INFO - 
================================================================================
2025-04-01 09:08:51,368 - root - INFO - MODEL ARCHITECTURE INFORMATION
2025-04-01 09:08:51,368 - root - INFO - ================================================================================
2025-04-01 09:08:51,368 - root - INFO - User Input Dimension: 81
2025-04-01 09:08:51,368 - root - INFO - Item Input Dimension: 25
2025-04-01 09:08:51,368 - root - INFO - User Hidden Dimensions: [128, 64]
2025-04-01 09:08:51,368 - root - INFO - Item Hidden Dimensions: [128, 64]
2025-04-01 09:08:51,368 - root - INFO - Embedding Dimension: 32
2025-04-01 09:08:51,368 - root - INFO - Final Layer Size: 16
2025-04-01 09:08:51,368 - root - INFO - Dropout Rate: 0.2
2025-04-01 09:08:51,368 - root - INFO - Activation Function: relu
2025-04-01 09:08:51,368 - root - INFO - ================================================================================

2025-04-01 09:08:51,368 - models.two_tower_model - INFO - Initialized weights
2025-04-01 09:08:51,368 - models.two_tower_model - INFO - Initialized Two-Tower model with user input dim: 81, item input dim: 25, embedding dim: 32
2025-04-01 09:08:52,935 - root - INFO - Tensorboard logging setup complete. Log directory: logs\tensorboard\20250401-090852
2025-04-01 09:08:52,935 - training.trainer - INFO - Trainer initialized on device: cpu
2025-04-01 09:08:52,935 - root - INFO - Starting training...
2025-04-01 09:08:52,947 - training.trainer - INFO - Starting training for 100 epochs
2025-04-01 09:08:52,947 - training.trainer - INFO - 
================================================================================
2025-04-01 09:08:52,947 - training.trainer - INFO - TRAINING DATA INFORMATION
2025-04-01 09:08:52,947 - training.trainer - INFO - ================================================================================
2025-04-01 09:08:53,004 - training.trainer - INFO - Batch keys: ['user_id', 'item_id', 'user_features', 'item_features', 'target']
2025-04-01 09:08:53,004 - training.trainer - INFO - User features shape: torch.Size([64, 81]), dtype: torch.float32
2025-04-01 09:08:53,004 - training.trainer - INFO - User features first row: [ 0.6864111  -0.7392429   0.02628803 -0.2689715  -0.23074162  0.22194713
 -0.13209148  0.67103624 -0.7614152  -0.01536492] (showing first 10 values)
2025-04-01 09:08:53,004 - training.trainer - INFO - Item features shape: torch.Size([64, 25]), dtype: torch.float32
2025-04-01 09:08:53,004 - training.trainer - INFO - Item features first row: [ 0.02309552  0.42726472 -2.243173   -0.22291532 -0.96223783 -0.5198264
  0.73105973 -0.4669337  -0.6572926   1.4471878 ] (showing first 10 values)
2025-04-01 09:08:53,004 - training.trainer - INFO - Targets shape: torch.Size([64]), dtype: torch.float32
2025-04-01 09:08:53,004 - training.trainer - INFO - Targets sample: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-04-01 09:08:53,025 - training.trainer - INFO - User IDs sample: tensor([3507., 4370., 4324., 4495., 1905., 3809., 3978., 1727.,  444., 2756.],
       dtype=torch.float64)
2025-04-01 09:08:53,025 - training.trainer - INFO - Item IDs sample: tensor([  22.,  401.,   74.,   17.,  195.,  923.,  359., 1233., 1337.,  803.],
       dtype=torch.float64)
2025-04-01 09:08:53,025 - training.trainer - INFO - ================================================================================
2025-04-01 09:08:53,025 - training.trainer - INFO - END OF TRAINING DATA INFORMATION
2025-04-01 09:08:53,025 - training.trainer - INFO - ================================================================================

2025-04-01 09:08:53,089 - training.trainer - INFO - 
================================================================================
2025-04-01 09:08:53,089 - training.trainer - INFO - FIRST BATCH MODEL I/O INFORMATION
2025-04-01 09:08:53,089 - training.trainer - INFO - ================================================================================
2025-04-01 09:08:53,089 - training.trainer - INFO - Model input - User features shape: torch.Size([64, 81])
2025-04-01 09:08:53,089 - training.trainer - INFO - Model input - Item features shape: torch.Size([64, 25])
2025-04-01 09:08:53,089 - training.trainer - INFO - Model output shape: torch.Size([64])
2025-04-01 09:08:53,089 - training.trainer - INFO - Model output sample (first 5 values): [0.53558236 0.5309042  0.45222324 0.52007824 0.47763517]
2025-04-01 09:08:53,089 - training.trainer - INFO - Target values (first 5): [0. 0. 0. 0. 0.]
2025-04-01 09:08:53,089 - training.trainer - INFO - ================================================================================

2025-04-01 09:09:05,675 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:09:05,675 - training.trainer - INFO - Epoch 1 Results:
2025-04-01 09:09:05,691 - training.trainer - INFO - Training: accuracy=0.8924 precision=0.0522 recall=0.0092 f1=0.0157 auc=0.4903 tn=6241.0000 fp=109.0000 fn=644.0000 tp=6.0000 loss=0.3776 epoch_time=9.9900 
2025-04-01 09:09:05,691 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5786 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0947 ndcg@10=0.0947 ndcg@20=0.0947 map@5=0.0933 map@10=0.0933 map@20=0.0933 loss=0.3128 
2025-04-01 09:09:05,715 - models.two_tower_model - INFO - Model saved to models/checkpoints\model_epoch_1.pt
2025-04-01 09:09:05,720 - models.two_tower_model - INFO - Model saved to models/checkpoints\best_model.pt
2025-04-01 09:09:05,720 - training.trainer - INFO - Saved new best model with validation loss: 0.3128
2025-04-01 09:09:17,179 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:09:17,180 - training.trainer - INFO - Epoch 2 Results:
2025-04-01 09:09:17,180 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5667 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.3215 epoch_time=9.1789 
2025-04-01 09:09:17,180 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6049 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0955 ndcg@10=0.0955 ndcg@20=0.0955 map@5=0.0944 map@10=0.0944 map@20=0.0944 loss=0.3033 
2025-04-01 09:09:17,196 - models.two_tower_model - INFO - Model saved to models/checkpoints\model_epoch_2.pt
2025-04-01 09:09:17,196 - models.two_tower_model - INFO - Model saved to models/checkpoints\best_model.pt
2025-04-01 09:09:17,196 - training.trainer - INFO - Saved new best model with validation loss: 0.3033
2025-04-01 09:09:28,448 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:09:28,448 - training.trainer - INFO - Epoch 3 Results:
2025-04-01 09:09:28,448 - training.trainer - INFO - Training: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5627 tn=6349.0000 fp=1.0000 fn=650.0000 tp=0.0000 loss=0.3209 epoch_time=8.9129 
2025-04-01 09:09:28,448 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6049 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0955 ndcg@10=0.0955 ndcg@20=0.0955 map@5=0.0944 map@10=0.0944 map@20=0.0944 loss=0.3063 
2025-04-01 09:09:28,466 - training.trainer - INFO - Early stopping counter: 1/10
2025-04-01 09:09:40,464 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:09:40,464 - training.trainer - INFO - Epoch 4 Results:
2025-04-01 09:09:40,464 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5908 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.3124 epoch_time=9.3760 
2025-04-01 09:09:40,464 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5934 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0948 ndcg@10=0.0948 ndcg@20=0.0948 map@5=0.0935 map@10=0.0935 map@20=0.0935 loss=0.3055 
2025-04-01 09:09:40,481 - training.trainer - INFO - Early stopping counter: 2/10
2025-04-01 09:09:51,756 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:09:51,756 - training.trainer - INFO - Epoch 5 Results:
2025-04-01 09:09:51,756 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6162 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.3077 epoch_time=9.1505 
2025-04-01 09:09:51,756 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5819 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0953 ndcg@10=0.0953 ndcg@20=0.0953 map@5=0.0941 map@10=0.0941 map@20=0.0941 loss=0.3072 
2025-04-01 09:09:51,756 - training.trainer - INFO - Early stopping counter: 3/10
2025-04-01 09:10:03,407 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:10:03,411 - training.trainer - INFO - Epoch 6 Results:
2025-04-01 09:10:03,411 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6370 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.3029 epoch_time=9.3780 
2025-04-01 09:10:03,411 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6022 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0953 ndcg@10=0.0953 ndcg@20=0.0953 map@5=0.0941 map@10=0.0941 map@20=0.0941 loss=0.3061 
2025-04-01 09:10:03,423 - training.trainer - INFO - Early stopping counter: 4/10
2025-04-01 09:10:15,090 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:10:15,106 - training.trainer - INFO - Epoch 7 Results:
2025-04-01 09:10:15,106 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6647 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.2981 epoch_time=9.5525 
2025-04-01 09:10:15,106 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6076 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0953 ndcg@10=0.0953 ndcg@20=0.0953 map@5=0.0941 map@10=0.0941 map@20=0.0941 loss=0.3163 
2025-04-01 09:10:15,117 - training.trainer - INFO - Early stopping counter: 5/10
2025-04-01 09:10:26,643 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:10:26,645 - training.trainer - INFO - Epoch 8 Results:
2025-04-01 09:10:26,645 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6757 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.2960 epoch_time=9.3401 
2025-04-01 09:10:26,645 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5963 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0953 ndcg@10=0.0953 ndcg@20=0.0953 map@5=0.0941 map@10=0.0941 map@20=0.0941 loss=0.3104 
2025-04-01 09:10:26,647 - training.trainer - INFO - Early stopping counter: 6/10
2025-04-01 09:10:38,114 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:10:38,120 - training.trainer - INFO - Epoch 9 Results:
2025-04-01 09:10:38,120 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.7043 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.2894 epoch_time=9.1457 
2025-04-01 09:10:38,121 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5950 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0953 ndcg@10=0.0953 ndcg@20=0.0953 map@5=0.0941 map@10=0.0941 map@20=0.0941 loss=0.3109 
2025-04-01 09:10:38,132 - training.trainer - INFO - Early stopping counter: 7/10
2025-04-01 09:10:50,080 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:10:50,080 - training.trainer - INFO - Epoch 10 Results:
2025-04-01 09:10:50,080 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.7145 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.2859 epoch_time=9.6623 
2025-04-01 09:10:50,080 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5930 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0950 ndcg@10=0.0950 ndcg@20=0.0950 map@5=0.0937 map@10=0.0937 map@20=0.0937 loss=0.3119 
2025-04-01 09:10:50,097 - training.trainer - INFO - Early stopping counter: 8/10
2025-04-01 09:11:01,477 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:11:01,477 - training.trainer - INFO - Epoch 11 Results:
2025-04-01 09:11:01,477 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.7297 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.2789 epoch_time=8.8678 
2025-04-01 09:11:01,477 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.6022 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0953 ndcg@10=0.0953 ndcg@20=0.0953 map@5=0.0941 map@10=0.0941 map@20=0.0941 loss=0.3138 
2025-04-01 09:11:01,498 - training.trainer - INFO - Early stopping counter: 9/10
2025-04-01 09:11:13,264 - training.trainer - INFO - --------------------------------------------------
2025-04-01 09:11:13,264 - training.trainer - INFO - Epoch 12 Results:
2025-04-01 09:11:13,265 - training.trainer - INFO - Training: accuracy=0.9071 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.7253 tn=6350.0000 fp=0.0000 fn=650.0000 tp=0.0000 loss=0.2810 epoch_time=9.4191 
2025-04-01 09:11:13,265 - training.trainer - INFO - Validation: accuracy=0.9070 precision=0.0000 recall=0.0000 f1=0.0000 auc=0.5987 tn=907.0000 fp=0.0000 fn=93.0000 tp=0.0000 ndcg@5=0.0953 ndcg@10=0.0953 ndcg@20=0.0953 map@5=0.0941 map@10=0.0941 map@20=0.0941 loss=0.3170 
2025-04-01 09:11:13,276 - training.trainer - INFO - Early stopping counter: 10/10
2025-04-01 09:11:13,276 - training.trainer - INFO - Early stopping triggered after 12 epochs
2025-04-01 09:11:13,277 - training.trainer - INFO - Training completed
2025-04-01 09:11:13,284 - root - INFO - Training history saved to logs\training_history.csv
2025-04-01 09:11:13,284 - root - INFO - Evaluating model on test set...
2025-04-01 09:11:13,284 - training.trainer - INFO - Evaluating model on test set
2025-04-01 09:11:15,902 - training.trainer - INFO - Test Results:
2025-04-01 09:11:15,902 - training.trainer - INFO -   accuracy: 0.9070
2025-04-01 09:11:15,902 - training.trainer - INFO -   precision: 0.0000
2025-04-01 09:11:15,902 - training.trainer - INFO -   recall: 0.0000
2025-04-01 09:11:15,902 - training.trainer - INFO -   f1: 0.0000
2025-04-01 09:11:15,902 - training.trainer - INFO -   auc: 0.6127
2025-04-01 09:11:15,902 - training.trainer - INFO -   tn: 1814.0000
2025-04-01 09:11:15,902 - training.trainer - INFO -   fp: 0.0000
2025-04-01 09:11:15,902 - training.trainer - INFO -   fn: 186.0000
2025-04-01 09:11:15,902 - training.trainer - INFO -   tp: 0.0000
2025-04-01 09:11:15,902 - training.trainer - INFO -   ndcg@5: 0.1074
2025-04-01 09:11:15,902 - training.trainer - INFO -   ndcg@10: 0.1074
2025-04-01 09:11:15,902 - training.trainer - INFO -   ndcg@20: 0.1074
2025-04-01 09:11:15,902 - training.trainer - INFO -   map@5: 0.1054
2025-04-01 09:11:15,902 - training.trainer - INFO -   map@10: 0.1054
2025-04-01 09:11:15,902 - training.trainer - INFO -   map@20: 0.1054
2025-04-01 09:11:15,902 - training.trainer - INFO -   loss: 0.3117
2025-04-01 09:11:15,918 - training.trainer - INFO - Saved test results to logs\test_results.csv
2025-04-01 09:11:15,918 - training.trainer - INFO - Generating evaluation plots
2025-04-01 09:11:17,963 - training.trainer - INFO - Evaluation plots saved to logs\evaluation_plots
2025-04-01 09:11:17,963 - root - INFO - Test Set Metrics:
2025-04-01 09:11:17,963 - root - INFO - accuracy: 0.9070
2025-04-01 09:11:17,963 - root - INFO - precision: 0.0000
2025-04-01 09:11:17,963 - root - INFO - recall: 0.0000
2025-04-01 09:11:17,963 - root - INFO - f1: 0.0000
2025-04-01 09:11:17,963 - root - INFO - auc: 0.6127
2025-04-01 09:11:17,963 - root - INFO - tn: 1814.0000
2025-04-01 09:11:17,963 - root - INFO - fp: 0.0000
2025-04-01 09:11:17,963 - root - INFO - fn: 186.0000
2025-04-01 09:11:17,963 - root - INFO - tp: 0.0000
2025-04-01 09:11:17,963 - root - INFO - ndcg@5: 0.1074
2025-04-01 09:11:17,963 - root - INFO - ndcg@10: 0.1074
2025-04-01 09:11:17,963 - root - INFO - ndcg@20: 0.1074
2025-04-01 09:11:17,968 - root - INFO - map@5: 0.1054
2025-04-01 09:11:17,968 - root - INFO - map@10: 0.1054
2025-04-01 09:11:17,968 - root - INFO - map@20: 0.1054
2025-04-01 09:11:17,968 - root - INFO - loss: 0.3117
2025-04-01 09:11:17,971 - root - INFO - Test metrics saved to evaluation/metrics\test_metrics.csv
2025-04-01 09:11:17,975 - models.two_tower_model - INFO - Model saved to models/checkpoints\final_model_with_manifest.pt
2025-04-01 09:11:17,975 - root - INFO - Model saved with feature manifest to models/checkpoints\final_model_with_manifest.pt
2025-04-01 09:11:17,975 - root - INFO - ================================================================================
2025-04-01 09:11:17,976 - root - INFO - Training completed at 2025-04-01 09:11:17
2025-04-01 09:11:17,976 - root - INFO - ================================================================================
