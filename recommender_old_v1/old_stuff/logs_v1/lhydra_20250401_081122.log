[2025-04-01 08:11:22,145] [INFO] [logger:__init__:77] - Logger initialized. Log directory: C:\Users\mecha\Documents\lhydra-hybrid\logs
[2025-04-01 08:11:22,145] [INFO] [generate_recommendations_v2:main:468] - ================================================================================
[2025-04-01 08:11:22,145] [INFO] [generate_recommendations_v2:main:469] - Starting recommendation generation at 20250401_081122
[2025-04-01 08:11:22,145] [INFO] [generate_recommendations_v2:main:470] - ================================================================================
[2025-04-01 08:11:22,145] [INFO] [generate_recommendations_v2:main:477] - Using device: cpu
[2025-04-01 08:11:22,145] [INFO] [generate_recommendations_v2:from_checkpoint:418] - Loading model from models/checkpoints/best_model.pt
[2025-04-01 08:11:22,219] [INFO] [generate_recommendations_v2:from_checkpoint:422] - Loading user features from notebooks/shipping_10k_data/features/user_features.csv
[2025-04-01 08:11:22,336] [INFO] [generate_recommendations_v2:from_checkpoint:425] - Loading item features from notebooks/shipping_10k_data/features/item_features.csv
[2025-04-01 08:11:22,356] [INFO] [generate_recommendations_v2:__init__:66] - Model has feature manifest. Feature alignment will be used.
[2025-04-01 08:11:22,358] [INFO] [generate_recommendations_v2:__init__:69] - Feature dimensions from manifest: user=115, item=65
[2025-04-01 08:11:22,360] [INFO] [generate_recommendations_v2:__init__:92] - Recommendation engine initialized with 4818 users and 1415 items
[2025-04-01 08:11:22,362] [INFO] [generate_recommendations_v2:main:489] - Recommendation engine initialized successfully
[2025-04-01 08:11:22,363] [DEBUG] [generate_recommendations_v2:main:494] - User ID field: user_id
[2025-04-01 08:11:22,364] [DEBUG] [generate_recommendations_v2:main:495] - Item ID field: track_id
[2025-04-01 08:11:22,366] [DEBUG] [generate_recommendations_v2:main:499] - Sample user IDs (first 5): [3954 4084 3280 2879 2015]
[2025-04-01 08:11:22,367] [DEBUG] [generate_recommendations_v2:main:500] - User IDs dtype: int64
[2025-04-01 08:11:22,368] [DEBUG] [generate_recommendations_v2:main:504] - Sample item IDs (first 5): [  20 1109  788  646  538]
[2025-04-01 08:11:22,370] [DEBUG] [generate_recommendations_v2:main:505] - Item IDs dtype: int64
[2025-04-01 08:11:22,375] [DEBUG] [generate_recommendations_v2:main:534] - User 290 existence check:
[2025-04-01 08:11:22,377] [DEBUG] [generate_recommendations_v2:main:535] -   - As string: found
[2025-04-01 08:11:22,379] [DEBUG] [generate_recommendations_v2:main:536] -   - As integer: found
[2025-04-01 08:11:22,381] [DEBUG] [generate_recommendations_v2:main:539] - First 10 user IDs for context: [3954 4084 3280 2879 2015 3658 2703 1114 2288  364]
[2025-04-01 08:11:22,381] [INFO] [generate_recommendations_v2:main:541] - Generating recommendations for user 290
[2025-04-01 08:11:22,381] [DEBUG] [logger:log_function_call:90] - FUNCTION CALL: predict_scores - Args: (<__main__.RecommendationEngine object at 0x000001C524920E60>, '290'), Kwargs: {'top_k': 10}
[2025-04-01 08:11:22,386] [INFO] [generate_recommendations_v2:predict_scores:179] - Found user 290 in user features
[2025-04-01 08:11:22,472] [DEBUG] [logger:log_function_call:90] - FUNCTION CALL: _prepare_features_for_prediction - Args: (<__main__.RecommendationEngine object at 0x000001C524920E60>,            age  monthly_hours  ...  age_group_genre_young_adult_unknown  user_id
4003  0.553178      -1.538306  ...                                  0.0      290

[1 rows x 82 columns]), Kwargs: None
[2025-04-01 08:11:22,487] [DEBUG] [logger:debug:176] - Function _prepare_features_for_prediction executed in 0.0156 seconds
[2025-04-01 08:11:22,659] [ERROR] [generate_recommendations_v2:predict_scores:224] - Error during prediction: mat1 and mat2 shapes cannot be multiplied (1415x114650 and 81x128)
[2025-04-01 08:11:22,661] [DEBUG] [logger:debug:176] - Function predict_scores executed in 0.2785 seconds
[2025-04-01 08:11:22,661] [WARNING] [generate_recommendations_v2:main:577] - No recommendations generated
[2025-04-01 08:11:22,661] [INFO] [generate_recommendations_v2:main:580] - ================================================================================
[2025-04-01 08:11:22,661] [INFO] [generate_recommendations_v2:main:581] - Recommendation generation completed at 20250401_081122
[2025-04-01 08:11:22,661] [INFO] [generate_recommendations_v2:main:582] - ================================================================================
[2025-04-01 08:11:22,661] [DEBUG] [logger:debug:176] - Function main executed in 0.5159 seconds
